(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9616],{37484:(e,t,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/imoveis/[id]",function(){return a(77237)}])},77237:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});var s=a(37876),r=a(89099),l=a(14232),o=a(82427);function n(){let{id:e}=(0,r.useRouter)().query,[t,a]=(0,l.useState)(null),[n,i]=(0,l.useState)(1),[c,d]=(0,l.useState)(null),[m,u]=(0,l.useState)(""),[x,h]=(0,l.useState)(!0);(0,l.useEffect)(()=>{e&&o.A.get("/properties/".concat(e)).then(e=>{a(e.data),u(e.data.valor_unitario||"")}).catch(e=>{var t;(null==e||null==(t=e.response)?void 0:t.status)===401?(localStorage.removeItem("token"),window.location.href="/user/login-v3"):d("Erro ao carregar im\xf3vel.")}).finally(()=>h(!1))},[e]);let b=async()=>{try{let t=localStorage.getItem("token"),a=null;if(t)try{let e=JSON.parse(atob(t.split(".")[1]));a=e.id||e.user_id||e.sub}catch(e){}let s=new Date,r=e=>e.toString().padStart(2,"0"),l="".concat(s.getFullYear(),"-").concat(r(s.getMonth()+1),"-").concat(r(s.getDate())," ").concat(r(s.getHours()),":").concat(r(s.getMinutes()),":").concat(r(s.getSeconds())),i={id_investidor:a,id_imovel:Number(e),qtd_tokens:Number(n),valor_unitario:Number(m)||0,data_compra:l,origem:"plataforma",status:"ativo"};await o.A.post("/investments/purchase",i),alert("Compra realizada!")}catch(e){console.error(e),alert("Erro na compra")}};return x?(0,s.jsx)("div",{className:"p-4 text-gray-500 animate-pulse",children:"Carregando im\xf3vel..."}):c?(0,s.jsx)("div",{className:"p-4 text-red-500",children:c}):t?(0,s.jsxs)("div",{className:"p-4 max-w-2xl mx-auto",children:[(0,s.jsxs)("div",{className:"bg-white border border-gray-200 rounded-xl shadow p-6 mb-6",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold mb-2 text-theme",children:t.titulo}),(0,s.jsx)("div",{className:"mb-2 text-gray-700 text-lg",children:t.descricao}),(0,s.jsxs)("div",{className:"mb-1 text-sm",children:[(0,s.jsx)("b",{children:"Localiza\xe7\xe3o:"})," ",t.localizacao]}),(0,s.jsxs)("div",{className:"mb-1 text-sm",children:[(0,s.jsx)("b",{children:"Valor Total:"})," R$ ",Number(t.valor_total).toLocaleString("pt-BR",{minimumFractionDigits:2})]}),(0,s.jsxs)("div",{className:"mb-1 text-sm",children:[(0,s.jsx)("b",{children:"Tokens:"})," ",t.qtd_tokens]}),(0,s.jsxs)("div",{className:"mb-1 text-sm",children:[(0,s.jsx)("b",{children:"Status:"})," ",(0,s.jsx)("span",{className:"px-2 py-1 rounded text-xs font-semibold ".concat("ativo"===t.status?"bg-green-100 text-green-700":"bg-gray-200 text-gray-600"),children:t.status})]}),(0,s.jsxs)("div",{className:"mb-1 text-sm",children:[(0,s.jsx)("b",{children:"Data Tokeniza\xe7\xe3o:"})," ",t.data_tokenizacao]})]}),(0,s.jsxs)("div",{className:"bg-gray-50 border border-gray-200 rounded-xl shadow p-6",children:[(0,s.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Comprar tokens deste im\xf3vel"}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)("label",{className:"block font-medium",children:"Quantidade de tokens:"}),(0,s.jsx)("input",{type:"number",min:"1",value:n,onChange:e=>i(e.target.value),className:"border p-2 rounded w-full"}),(0,s.jsx)("label",{className:"block font-medium",children:"Valor unit\xe1rio:"}),(0,s.jsx)("input",{type:"number",min:"0",value:m,onChange:e=>u(e.target.value),className:"border p-2 rounded w-full"}),(0,s.jsx)("button",{onClick:b,className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded w-full mt-4 transition",children:"Comprar Tokens"})]})]})]}):(0,s.jsx)("div",{className:"p-4",children:"Im\xf3vel n\xe3o encontrado."})}},82427:(e,t,a)=>{"use strict";a.d(t,{A:()=>o});var s=a(91040),r=a(65364);let l=s.A.create({baseURL:r.env.NEXT_PUBLIC_API_BASE_URL||"http://localhost:8000/api"});l.interceptors.request.use(e=>{{let t=localStorage.getItem("admin_token"),a=localStorage.getItem("token"),s=t||a;s&&(e.headers.Authorization="Bearer ".concat(s))}return e});let o=l},89099:(e,t,a)=>{e.exports=a(84294)}},e=>{var t=t=>e(e.s=t);e.O(0,[1040,636,6593,8792],()=>t(37484)),_N_E=e.O()}]);