!function(t){"use strict";var i="nav-menu",n="nav-title",E=".nav-link-text",f="js-filter-hide",_="js-filter-show",s="js-list-filter",e="js-list-active",r=100,h=100,p=1e3,L=1e4,m={EXACT:3,SUBSTRING:2,CONSECUTIVE:.5,CONSECUTIVE_BONUS:.1,NON_CONSECUTIVE:.3,PREFIX_BONUS:.2,CASE_MATCH_BONUS:.1};function a(i,n,r){var a,o=0;return function(){var t,e=this,s=arguments;Date.now()-o<h||(t=r&&!a,clearTimeout(a),a=setTimeout(function(){a=null,r||(o=Date.now(),i.apply(e,s))},n),t&&(o=Date.now(),i.apply(e,s)))}}var w=new Map;function y(t,e){try{if(!t||!e)return 0;var s=t+"|"+e;if(w.has(s))return w.get(s);w.size>L&&w.clear();var i=t.toLowerCase(),n=e.toLowerCase(),r=0;if(e===t)return r=m.EXACT,w.set(s,r),r;if(n.includes(i))return r=m.SUBSTRING,e.includes(t)&&(r+=m.CASE_MATCH_BONUS),n.startsWith(i)&&(r+=m.PREFIX_BONUS),w.set(s,r),r;for(var a=0,o=-1,h=0,l=!0,c=0;c<e.length&&a<t.length;c++)i[a]===n[c]&&(l&&(r+=m.PREFIX_BONUS*(1-c/e.length),l=!1),o===c-1?(h++,r+=m.CONSECUTIVE+h*m.CONSECUTIVE_BONUS):(h=0,r+=m.NON_CONSECUTIVE),t[a]===e[c]&&(r+=m.CASE_MATCH_BONUS),o=c,a++);var u=a===t.length?r:0;return 0<u&&(u*=t.length/e.length),w.set(s,u),u}catch(t){return console.error("Fuzzy match error:",t),0}}function o(t,e,s){try{if(!(this instanceof o))throw new Error("ListFilter must be called with new keyword");if(!t||!e)throw new Error("List and input parameters are required");if(this.list="string"==typeof t?document.querySelector(t):t,this.input="string"==typeof e?document.querySelector(e):e,!this.list||!this.input)throw new Error("Required elements not found. Check your selectors.");if(!(this.list instanceof Element&&this.input instanceof Element))throw new Error("Invalid DOM elements provided");var i={anchor:null,messageSelector:".js-filter-message",debounceWait:250,minLength:1,maxLength:r,caseSensitive:!1,onFilter:null,onReset:null,onError:null};this.settings=Object.assign({},i,this._validateOptions(s)),this.anchor="string"==typeof this.settings.anchor?document.querySelector(this.settings.anchor):this.settings.anchor,this._cache={items:null,titles:null,messageElement:null,size:0},this._errorCount=0,this._lastErrorTime=0,this.init()}catch(t){throw console.error("ListFilter constructor error:",t),s&&"function"==typeof s.onError&&s.onError(t),t}}o.prototype={_validateOptions:function(t){if(!t)return{};var e={};try{if("object"!=typeof t)throw new Error("Options must be an object");void 0!==t.minLength&&(e.minLength=Math.max(1,parseInt(t.minLength,10)||1)),void 0!==t.maxLength&&(e.maxLength=Math.min(r,parseInt(t.maxLength,10)||r)),void 0!==t.debounceWait&&(e.debounceWait=Math.max(50,parseInt(t.debounceWait,10)||250)),e.caseSensitive=!!t.caseSensitive,t.onFilter&&"function"==typeof t.onFilter&&(e.onFilter=t.onFilter),t.onReset&&"function"==typeof t.onReset&&(e.onReset=t.onReset),t.onError&&"function"==typeof t.onError&&(e.onError=t.onError),t.messageSelector&&"string"==typeof t.messageSelector&&(e.messageSelector=t.messageSelector),t.anchor&&(e.anchor=t.anchor)}catch(t){return console.error("Options validation error:",t),{}}return e},init:function(){try{(this.anchor||this.list).classList.add(s);var t=this.list.getElementsByTagName("a"),e=this.list.getElementsByTagName("li");if(!t.length||!e.length)throw new Error("No filterable items found in the list");this._cache.items=t,this._cache.titles=e,this._cache.messageElement=document.querySelector(this.settings.messageSelector),this._updateCacheSize(),this.bindEvents()}catch(t){throw this._handleError(t),t}},_updateCacheSize:function(){try{this._cache.size=0,this._cache.items&&(this._cache.size+=this._cache.items.length),this._cache.titles&&(this._cache.size+=this._cache.titles.length),this._cache.size>L&&w.clear()}catch(t){this._handleError(t)}},_handleError:function(t){console.error("ListFilter error:",t);var e=Date.now();6e4<e-this._lastErrorTime&&(this._errorCount=0),this._errorCount++,this._lastErrorTime=e,this.settings.onError&&this.settings.onError(t),10<this._errorCount&&(this.reset(),this._errorCount=0)},bindEvents:function(){try{var e=this;this.handleFilter=a(this.filter.bind(this),this.settings.debounceWait),this.input.addEventListener("input",this._validateEvent.bind(this),{passive:!0}),this.input.addEventListener("change",this._validateEvent.bind(this),{passive:!0}),document.addEventListener("keydown",function(t){"Escape"!==t.key&&"Esc"!==t.key||e.reset()}),this._cache.messageElement&&this._cache.messageElement.addEventListener("click",function(t){t.preventDefault(),t.target!==e._cache.messageElement&&!e._cache.messageElement.contains(t.target)||((t=bootstrap.Tooltip.getInstance(e._cache.messageElement))&&(t.dispose(),new bootstrap.Tooltip(e._cache.messageElement)),e.reset())}),this._resizeHandler=a(function(){e.input.value.length>e.settings.minLength&&e.filter()},250),t.addEventListener("resize",this._resizeHandler,{passive:!0}),this.input.setAttribute("maxlength",this.settings.maxLength.toString())}catch(t){this._handleError(t)}},_validateEvent:function(t){try{var e;t&&t instanceof Event&&t.target===this.input&&((e=this.input.value).length>this.settings.maxLength?this.input.value=e.slice(0,this.settings.maxLength):this.handleFilter(t))}catch(t){this._handleError(t)}},findNavTitle:function(t){try{if(!(t&&t instanceof Element))throw new Error("Invalid element provided to findNavTitle");for(var e=t;e&&!e.classList.contains(i);){for(var s=e.previousElementSibling;s;){if(s.classList.contains(n))return s;s=s.previousElementSibling}e=e.parentElement}return null}catch(t){return this._handleError(t),null}},showParents:function(t){try{if(!(t&&t instanceof Element))throw new Error("Invalid element provided to showParents");for(var e=t.parentElement;e&&!e.classList.contains(i);)"LI"===e.tagName&&(e.classList.remove(f),e.classList.add(_)),e=e.parentElement}catch(t){this._handleError(t)}},showChildren:function(t){try{if(!(t&&t instanceof Element))throw new Error("Invalid element provided to showChildren");for(var e=t.querySelectorAll("li"),s=0;s<e.length;s++){var i=e[s];i.classList.contains(n)||(i.classList.remove(f),i.classList.add(_))}}catch(t){this._handleError(t)}},filter:function(){try{var t=this.input.value;t.length>this.settings.maxLength&&(t=t.slice(0,this.settings.maxLength),this.input.value=t),(t=this.settings.caseSensitive?t:t.toLowerCase()).length>this.settings.minLength?(this.list.classList.add(e),this._performFilter(t)):(this.list.classList.remove(e),this._resetFilter()),"function"==typeof this.settings.onFilter&&this.settings.onFilter.call(this,t)}catch(t){this._handleError(t),this._resetFilter()}},_performFilter:function(t){try{for(var e=0;e<this._cache.titles.length;e++)this._cache.titles[e].classList.remove(_),this._cache.titles[e].classList.add(f);for(var s=0,i=new Set,n=new Set,r=[],a=0;a<this._cache.items.length&&r.length<p;a++){var o=this._cache.items[a],h=function(t){try{var e;if(t&&t instanceof Element)return(e=t.querySelector(E))?e.textContent.trim():"";throw new Error("Invalid element provided to getNavItemText")}catch(t){return console.error("getNavItemText error:",t),""}}(o),l=o.getAttribute("title")||"",c=y(t,h),u=y(t,l),m=Math.max(c,u);0<m&&r.push({element:o,score:m})}r.sort(function(t,e){return e.score-t.score});for(var d=0;d<r.length;d++){var v,g=r[d].element.closest("li");g&&!i.has(g)&&(g.classList.remove(f),g.classList.add(_),this.showParents(g),this.showChildren(g),(v=this.findNavTitle(g))&&!n.has(v)&&(v.classList.remove(f),v.classList.add(_),n.add(v)),i.add(g),s++)}this._cache.messageElement&&(this._cache.messageElement.innerHTML=s,this._cache.messageElement.style.cursor="pointer"),w.size>L&&w.clear()}catch(t){this._handleError(t),this._resetFilter()}},_resetFilter:function(){try{this.list.classList.remove(e);for(var t=0;t<this._cache.titles.length;t++)this._cache.titles[t].classList.remove(f,_);this._cache.messageElement&&(this._cache.messageElement.textContent="")}catch(t){this._handleError(t)}},reset:function(){try{this.input.value="",this._resetFilter(),"function"==typeof this.settings.onReset&&this.settings.onReset.call(this)}catch(t){this._handleError(t)}},destroy:function(){try{this.input.removeEventListener("input",this._validateEvent),this.input.removeEventListener("change",this._validateEvent),t.removeEventListener("resize",this._resizeHandler),this._cache.messageElement&&this._cache.messageElement.removeEventListener("click",this.reset),this._resetFilter(),w.clear(),this._cache=null,this.input.removeAttribute("maxlength"),(this.anchor||this.list).classList.remove(s,e)}catch(t){this._handleError(t)}}},t.ListFilter=o}(window);