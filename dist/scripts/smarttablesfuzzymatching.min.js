import{SmartTables}from"./smartTables.bundle.js";document.addEventListener("DOMContentLoaded",()=>{const t=document.getElementById("tableContainer"),l=document.getElementById("threshold"),e=document.getElementById("thresholdValue"),s=document.getElementById("minMatchLength"),i=document.getElementById("minMatchLengthValue"),d=document.getElementById("multiWordThreshold"),c=document.getElementById("multiWordThresholdValue"),m=document.getElementById("maxDistance"),u=document.getElementById("maxDistanceValue"),h=document.getElementById("description"),a=document.getElementById("buildTable"),n=document.getElementById("destroyTable"),g=document.getElementById("searchExample"),o=document.getElementById("resetSettings");let r=null;function y(e){l.disabled=e,s.disabled=e,d.disabled=e,m.disabled=e,o.disabled=e}function b(){e.textContent=l.value,i.textContent=s.value,c.textContent=d.value,u.textContent=m.value;{var a=parseFloat(l.value),n=parseInt(s.value),o=parseFloat(d.value),r=parseInt(m.value);let e="",t=(e=(e=(e=(e+=0===a?"• <strong>Exact matching only</strong> - No partial matches<br>":a<.3?"• <strong>Minor fuzzy matching</strong> - Requires high similarity<br>":a<.6?"• <strong>Moderate fuzzy matching</strong> - Allows reasonable variations<br>":a<1?"• <strong>High fuzzy matching</strong> - Will find loosely related terms<br>":"• <strong>Maximum fuzzy matching</strong> - Will track down distant relatives like an overenthusiastic family reunion<br>")+(1===n?"• Will match even with a <strong>single character</strong><br>":"• Requires at least <strong>"+n+" characters</strong> to match<br>"))+(1===o?"• <strong>All words</strong> in a multi-word search must match<br>":.5<o?"• <strong>Most words</strong> in a multi-word search must match<br>":0<o?"• <strong>Some words</strong> in a multi-word search must match<br>":"• <strong>Any word</strong> in a multi-word search can match<br>"))+(0===r?"• <strong>No typo tolerance</strong> - Characters must match exactly<br>":1===r?"• <strong>Single typo tolerance</strong> - Allows 1 character mismatch<br>":r<5?"• <strong>Moderate typo tolerance</strong> - Allows "+r+" character mismatches<br>":"• <strong>High typo tolerance</strong> - Allows many character mismatches<br>"),"");0===a&&0===r?t="Try searching for exact terms like 'John' or 'Do'":(0<a||0<r)&&(t=0<r?"Try searches with typos like 'Jhon' instead of 'John' or 'Subrey' instead of 'Surgery'":"Try partial searches like 'Jo' for 'John' or 'Surg' for 'Surgery'"),g.textContent=t,h.innerHTML=e}}l.min=0,l.max=1,l.step=.1,l.value=0,s.min=1,s.max=5,s.step=1,s.value=1,d.min=0,d.max=1,d.step=.1,d.value=1,m.min=0,m.max=10,m.step=1,m.value=0,l.addEventListener("input",b),s.addEventListener("input",b),d.addEventListener("input",b),m.addEventListener("input",b),o.addEventListener("click",()=>{l.value=.7,s.value=2,d.value=.5,m.value=2,b()}),a.addEventListener("click",()=>{r&&(r.destroy(),r=null);var e={threshold:parseFloat(l.value),minMatchLength:parseInt(s.value),multiWordThreshold:parseFloat(d.value),maxDistance:parseInt(m.value)};console.log("Building table with fuzzy search settings:",e),t.classList.remove("d-none"),r=new SmartTables("myTable",{data:{type:"json",source:"json/MOCK_DATA_HOSPITAL.json",columns:[{data:"PatientID",title:"ID"},{data:"PatientName",title:"First Name"},{data:"Phone",title:"Phone"},{data:"DOB",title:"DOB"},{data:"Service",title:"Service"},{data:"ServiceDate",title:"Service Date"},{data:"Severity",title:"Severity",render:function(e){return'<span class="'+({Mild:"badge bg-success",Moderate:"badge bg-warning text-dark",Severe:"badge bg-danger"}[e]||"badge bg-dark")+'">'+e+"</span>"}},{data:"BillPaid",title:"Bill Paid"},{data:"BillDue",title:"Bill Due"},{data:"Department",title:"Department"},{data:"Staff",title:"Doctor"},{data:"Nurse",title:"Nurse"}]},fuzzyMatch:e,perPage:6,search:!0,sort:!0,pagination:!0,debug:!1,loading:{enabled:!0,duration:800},responsive:{enabled:!0,breakpoint:768,columnPriorities:{0:1,1:2,2:3,3:4,4:5,5:6,6:7,7:8,8:9,9:10,10:11,11:12}}}),a.disabled=!0,y(!(n.disabled=!1)),console.log("Table created with actual fuzzy settings:",r.options.fuzzyMatch),setTimeout(()=>{console.log("Verifying table search functionality:"),console.log("- Search method type:",typeof r.handleSearch),console.log("- Fuzzy match method type:",typeof r.fuzzyMatch),console.log("- Is server-side:",r.options.data.serverSide),console.log("DETAILED FUZZY SEARCH SETTINGS:"),console.log("- Threshold:",r.options.fuzzyMatch.threshold,"(0-1, higher = more fuzzy)"),console.log("- Min Match Length:",r.options.fuzzyMatch.minMatchLength,"(min characters to match)"),console.log("- Multi-word Threshold:",r.options.fuzzyMatch.multiWordThreshold,"(0-1, lower = more lenient)"),console.log("- Max Distance:",r.options.fuzzyMatch.maxDistance,"(max character mismatches allowed)");console.log("FUZZY SEARCH TEST EXAMPLES:"),["john","jon","medical","surgery","surgry"].forEach(e=>{console.log(`Testing search term: "${e}"`),document.createElement("input").value=e,r.handleSearch.bind(r)(e),console.log(`Results found: ${r.filteredRows.length} rows`)})},1e3)}),n.addEventListener("click",()=>{r&&(r.destroy(),r=null),t.classList.add("d-none"),a.disabled=!1,y(!(n.disabled=!0))}),b(),n.disabled=!0});