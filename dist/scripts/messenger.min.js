document.addEventListener("DOMContentLoaded",()=>{const r=document.getElementById("chat_container"),a=document.getElementById("msgr_input");var e=document.getElementById("send_button"),t=document.querySelectorAll(".emoji");const i=document.querySelectorAll(".story-circle"),s=["That's interesting. Tell me more.","I completely understand what you mean.","I hadn't thought about it that way before.","That's great news!","LOL üòÇ That's hilarious!","Really? I'm surprised to hear that.","I'm not sure I agree, but I see your point.","Let's discuss this further when we meet.","Thanks for letting me know!","Sorry to hear that. Is there anything I can do to help?","Can we talk about this tomorrow? I need some time to think.","Wow! That's amazing! üëç","So how are you liking SmartAdmin?"],n=["./img/1.jpg","./img/2.jpg","./img/3.jpg","./img/4.jpg","./img/5.jpg"];function o(e=null){var t=e||a.value.trim();t&&(e||(a.value=""),d(t,"sent",(e=new Date).getHours().toString().padStart(2,"0")+":"+e.getMinutes().toString().padStart(2,"0")),m(),(t=document.createElement("div")).className="chat-segment chat-segment-get typing-indicator",t.innerHTML=`
            <div class="chat-message">
                <div class="typing">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </div>
        `,r.appendChild(t),m(),e=1e3+2e3*Math.random(),setTimeout(()=>{var e;(e=document.querySelector(".typing-indicator"))&&e.remove(),(e=Math.random())<.6?d(s[Math.floor(Math.random()*s.length)],"get",c()):e<.7?l(n[Math.floor(Math.random()*n.length)],"get",c()):e<.9&&d((e=["üëç","‚ù§Ô∏è","üòÇ","üéâ","üòÆ","üò¢","üò°"])[Math.floor(Math.random()*e.length)],"get",c()),m()},e))}function d(e,t,a){var i=document.createElement("div"),s=(i.className="chat-segment chat-segment-"+t,/^(\p{Emoji}\uFE0F?)+$/u.test(e)),n="üëç"===e?"like":"‚ù§Ô∏è"===e?"love":"üòÇ"===e?"haha":"üéâ"===e?"yay":"üòÆ"===e?"wow":"üò¢"===e?"sad":"üò°"===e?"angry":null;let o;o=n?`
                <div class="emoji emoji--${n}">
                    ${"like"===n?`<div class="emoji__hand">
                            <div class="emoji__thumb"></div>
                        </div>`:"love"===n?'<div class="emoji__heart"></div>':"haha"===n?`<div class="emoji__face">
                            <div class="emoji__eyes"></div>
                            <div class="emoji__mouth">
                                <div class="emoji__tongue"></div>
                            </div>
                        </div>`:"yay"===n?`<div class="emoji__face">
                            <div class="emoji__eyebrows"></div>
                            <div class="emoji__mouth"></div>
                        </div>`:"wow"===n||"sad"===n||"angry"===n?`<div class="emoji__face">
                            <div class="emoji__eyebrows"></div>
                            <div class="emoji__eyes"></div>
                            <div class="emoji__mouth"></div>
                        </div>`:""}
                </div>
                <div class="${"sent"===t?"text-end":""} fw-300 text-muted mt-1 fs-xs">
                    ${a}
                </div>
            `:`
                <div class="chat-message ${s?"emoji-only":""}">
                    <p>${e}</p>
                </div>
                <div class="${"sent"===t?"text-end":""} fw-300 text-muted mt-1 fs-xs">
                    ${a}
                </div>
            `,i.innerHTML=o,r.appendChild(i)}function l(e,t,a){var i=document.createElement("div");i.className="chat-segment chat-segment-"+t,i.innerHTML=`
            <div class="chat-message">
                <p><img src="${e}" class="img-fluid rounded" alt="Shared image" style="max-height: 200px;"></p>
            </div>
            <div class="${"sent"===t?"text-end":""} fw-300 text-muted mt-1 fs-xs">
                ${a}
            </div>
        `,r.appendChild(i)}function c(){var e=new Date;return e.getHours().toString().padStart(2,"0")+":"+e.getMinutes().toString().padStart(2,"0")}function m(){r.scrollTop=r.scrollHeight}i.length&&i.forEach(e=>{e.addEventListener("click",()=>{i.forEach(e=>e.classList.remove("active")),e.classList.add("active")})}),t.length&&t.forEach(t=>{t.addEventListener("click",e=>{e.preventDefault();e=t.classList.contains("emoji--like")?"üëç":t.classList.contains("emoji--love")?"‚ù§Ô∏è":t.classList.contains("emoji--haha")?"üòÇ":t.classList.contains("emoji--yay")?"üéâ":t.classList.contains("emoji--wow")?"üòÆ":t.classList.contains("emoji--sad")?"üò¢":t.classList.contains("emoji--angry")?"üò°":"";e&&o(e)})}),a&&a.addEventListener("keydown",e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),o())}),e&&e.addEventListener("click",()=>{o()});var t=document.createElement("style");t.textContent=`
        .typing {
            display: flex;
            align-items: center;
            height: 17px;
        }
        .typing span {
            background-color: #90949c;
            width: 7px;
            height: 7px;
            border-radius: 50%;
            margin: 0 2px;
            display: block;
            animation: typing 1.3s infinite ease-in-out;
        }
        .typing span:nth-child(1) {
            animation-delay: 0s;
        }
        .typing span:nth-child(2) {
            animation-delay: 0.2s;
        }
        .typing span:nth-child(3) {
            animation-delay: 0.4s;
        }
        @keyframes typing {
            0%, 60%, 100% {
                transform: translateY(0);
            }
            30% {
                transform: translateY(-5px);
            }
        }
        .emoji-only {
            font-size: 3rem;
        }
        
        /* Improved conversation list styling */
        #js-slide-right .list-group-item {
            transition: background-color 0.2s ease;
            border-radius: 8px;
            margin: 4px 8px;
            border: none;
        }
        
                            
               
        .unread-badge {
            background-color: var(--primary-500);
            color: white;
            font-size: 0.7rem;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        /* Story circles */
        .story-circle {
            cursor: pointer;
        }
        
        .story-circle.active .profile-image {
            border-color: var(--primary-500);
        }
        
        .story-circle .profile-image {
            border: 2px solid var(--bs-body-bg);
        }
        
        .story-circle.has-story .profile-image {
            border: 2px solid var(--primary-500);
        }
        
        /* Enhanced Emoji Styles */
        .chat-segment .emoji {
            transform: scale(2);
            margin: 16px;
            display: inline-block;
        }
        
        .chat-segment-sent .emoji {
            margin-left: auto;
        }
        
        .chat-segment-get .emoji {
            margin-right: auto;
        }
        
    `,document.head.appendChild(t);{r.querySelectorAll(".chat-segment:not(.d-flex)").forEach(e=>e.remove()),t=[{text:"Hi there! How's your day going?",type:"get",delay:0},{text:"Pretty good, thanks for asking! Just finished a big project.",type:"sent",delay:300},{text:"That's great to hear! Is this the same one you mentioned last week?",type:"get",delay:600},{text:"Yes, finally wrapped it up. The client was really happy with the results.",type:"sent",delay:900},{text:"Thanks for sharing the document! I'll take a look at it.",type:"get",delay:1500},{text:"Let me know if you need any clarification.",type:"sent",delay:1800},{image:n[2],type:"get",isImage:!0,delay:2100},{text:"That looks amazing! Is that from the project?",type:"sent",delay:2400},{text:"Yes, it's the final design we went with üòä",type:"get",delay:2700}];let e=0;t.forEach(n=>{setTimeout(()=>{var e,t,a,i,s;n.isImage?l(n.image,n.type,c()):n.isFile?(e=n.file,t=n.type,a=c(),(i=document.createElement("div")).className="chat-segment chat-segment-"+t,s="pdf"===e.type?"file-pdf text-danger":"doc"===e.type?"file-word text-primary":"xls"===e.type?"file-excel text-success":"ppt"===e.type?"file-powerpoint text-warning":"file text-muted",i.innerHTML=`
            <div class="chat-message">
                <div class="d-flex align-items-center p-2 rounded bg-white">
                    <i class="sa sa-${s} fs-2x me-2"></i>
                    <div class="flex-grow-1">
                        <div class="text-truncate fw-500">${e.name}</div>
                        <small class="text-muted">${e.size}</small>
                    </div>
                    <a href="javascript:void(0);" class="btn btn-sm btn-icon">
                        <i class="sa sa-download"></i>
                    </a>
                </div>
            </div>
            <div class="${"sent"===t?"text-end":""} fw-300 text-muted mt-1 fs-xs">
                ${a}
            </div>
        `,r.appendChild(i)):d(n.text,n.type,c()),m()},e),e+=n.delay})}e||(t=a.parentElement,(e=document.createElement("button")).id="send_button",e.className="btn btn-icon fs-xl width-1 flex-shrink-0",e.setAttribute("type","button"),e.setAttribute("data-bs-toggle","tooltip"),e.setAttribute("data-bs-original-title","Send"),e.setAttribute("data-bs-placement","top"),e.innerHTML='<svg class="sa-icon sa-bold sa-icon-subtlelight"><use href="img/sprite.svg#send"></use></svg>',t.appendChild(e),e.addEventListener("click",()=>{o()}))});