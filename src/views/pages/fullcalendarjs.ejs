<%- include('../partials/base.ejs', {
    pageTitle: 'FullCalendar.js',
    currentPage: 'fullcalendarjs',
    additionalJS: [
        'https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/highlight.min.js',
        'https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.11.1/languages/go.min.js'
    ],
    additionalCSS: [
        'https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/night-owl.min.css',
        'css/demo-docs.css'
    ],
    additionalScripts: `
        document.addEventListener('DOMContentLoaded', function() {
            hljs.highlightAll();
        });
    `,
    content: `
    
    <nav class="app-breadcrumb" aria-label="breadcrumb">
        <ol class="breadcrumb ms-0">
            <li class="breadcrumb-item">Config</li>
            <li class="breadcrumb-item">Documentation</li>
            <li class="breadcrumb-item">Addons</li>
            <li class="breadcrumb-item active" aria-current="page">FullCalendar.js</li>
        </ol>
    </nav>
    <div class="main-content">

    <h1 class="subheader-title">FullCalendar.js</h1>
           
    <div class="row">
            <div class="order-2 order-xl-1 col-lg-12 col-xl-9">          
           
            <section id="fullcalendar" class="concept-section">
                <h2 class="concept-title with-lead">Powerful Calendar Management for Modern Web Applications</h2>
                <p>FullCalendar is a full-sized, drag & drop JavaScript event calendar for modern browsers. It's designed to be a highly customizable solution for displaying and managing events, appointments, and schedules in web applications.</p>
                <p>
                    In SmartAdmin, FullCalendar is integrated with a custom Bootstrap theme (<code>fullcalendar.bootstrap.theme.js</code>) that ensures visual consistency with the rest of the application.
                </p>
                <div class="pro-tip">
                    <strong>Pro Tip:</strong> SmartAdmin's FullCalendar integration uses the Smart Admin icon system and Bootstrap styling for seamless visual integration with your dashboard.
                </div>
            </section>

            <section id="fullcalendar-installation" class="concept-section">
                <h2 class="concept-title">Installation</h2>
                <p>FullCalendar needs to be added to your project. Here's how to set it up:</p>

                <h4>1. Including Required Files</h4>
                <div class="code-example">
                    <pre><code>// Add the scripts as modules in your HTML
&lt;link href="./pathTo/fullcalendar.min.css" rel="stylesheet"&gt;
&lt;script type="module" src="./pathTo/fullcalendar.bundle.js"&gt;&lt;/script&gt;
&lt;script type="module" src="./pathTo/fullcalendar.bootstrap.theme.js"&gt;&lt;/script&gt;

// Or import them in your JavaScript module
import { FullCalendar } from './pathTo/fullcalendar.bundle.js';
import './pathTo/fullcalendar.bootstrap.theme.js';
// Make sure to also include the CSS in your HTML or via a CSS loader</code></pre>
                </div>

                <h4>2. Initialize a Calendar</h4>
                <div class="code-example">
                    <pre><code>// After importing the modules as shown above
document.addEventListener('DOMContentLoaded', function() {
    const calendarEl = document.getElementById('calendar');
    
    const calendar = new FullCalendar.Calendar(calendarEl, {
        themeSystem: 'bootstrap', // Use the SmartAdmin Bootstrap theme
        initialView: 'dayGridMonth',
        headerToolbar: {
            left: 'prev,next today',
            center: 'title',
            right: 'dayGridMonth,timeGridWeek,timeGridDay,listWeek'
        },
        events: [
            {
                title: 'Meeting',
                start: '2023-01-10T14:30:00',
                end: '2023-01-10T16:30:00'
            },
            {
                title: 'Conference',
                start: '2023-01-11',
                end: '2023-01-13'
            }
        ]
    });
    
    calendar.render();
});</code></pre>
                </div>

                <h4>HTML Structure</h4>
                <div class="code-example">
                    <pre><code>&lt;!-- Basic Calendar Container --&gt;
&lt;div id="calendar"&gt;&lt;/div&gt;

&lt;!-- Panel-Based Calendar Container (Recommended) --&gt;
&lt;div id="panel-1" class="panel"&gt;
    &lt;div class="panel-hdr"&gt;
        &lt;h2&gt;Calendar &lt;span class="fw-300"&gt;&lt;i&gt;View&lt;/i&gt;&lt;/span&gt;&lt;/h2&gt;
        &lt;div class="panel-toolbar"&gt;
            &lt;button class="btn btn-panel" data-action="panel-collapse"&gt;
                &lt;!-- Panel controls --&gt;
            &lt;/button&gt;
        &lt;/div&gt;
    &lt;/div&gt;
    &lt;div class="panel-container show"&gt;
        &lt;div class="panel-content"&gt;
            &lt;div id="calendar"&gt;&lt;/div&gt;
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/div&gt;</code></pre>
                </div>

                <div class="warning">
                    <strong>Important:</strong> 
                    <ul class="mb-0">
                        <li>You need to include the FullCalendar files in your project - they are not automatically loaded.</li>
                        <li>FullCalendar requires a container with a defined height. Without it, the calendar won't be visible.</li>
                        <li>Make sure to include both the JavaScript modules and the CSS file.</li>
                        <li>For more advanced documentation, refer to the <a href="https://fullcalendar.io/docs" target="_blank">official FullCalendar documentation</a>.</li>
                    </ul>
                </div>
            </section>

            <section id="fullcalendar-theme" class="concept-section">
                <h2 class="concept-title">SmartAdmin Bootstrap Theme</h2>
                <p>SmartAdmin includes a custom Bootstrap theme for FullCalendar that ensures visual consistency with the rest of the application. The theme is defined in <code>fullcalendar.bootstrap.theme.js</code>.</p>
                
                <div class="code-example">
                    <pre><code>// Excerpt from the bootstrap theme definition
class BootstrapTheme extends Theme {
    // CSS classes for various elements
    classes = {
        root: 'fc-theme-bootstrap',
        table: 'table table-calendar', // Uses Bootstrap table styling
        tableCellShaded: 'table-active',
        buttonGroup: 'btn-group',
        button: 'btn btn-outline-default btn-sm',
        buttonActive: 'active',
        popover: 'popover',
        popoverHeader: 'popover-header',
        popoverContent: 'popover-body',
    };
    
    // Icon definitions using SmartAdmin icon system
    baseIconClass = 'sa';
    iconClasses = {
        close: 'sa-close',
        prev: 'sa-chevron-left',
        next: 'sa-chevron-right',
        prevYear: 'sa-angle-double-left',
        nextYear: 'sa-angle-double-right',
    };
}</code></pre>
                </div>
                
                <div class="pro-tip">
                    <strong>Pro Tip:</strong> The SmartAdmin theme uses our custom icon system with the <code>sa-</code> prefix. This ensures all calendar controls match the rest of your application's design.
                </div>
            </section>

            <section id="fullcalendar-options" class="concept-section">
                <h2 class="concept-title">Configuration Options</h2>
                <p>FullCalendar offers extensive configuration options. Here are some of the most common ones:</p>
                
                <div class="table-responsive mb-4 mt-4">
                    <table class="table table-striped table-clean">
                        <thead>
                            <tr>
                                <th>Option</th>
                                <th>Type</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>initialView</code></td>
                                <td>String</td>
                                <td>The initial view when the calendar loads. Options: 'dayGridMonth', 'timeGridWeek', 'timeGridDay', 'listWeek'</td>
                            </tr>
                            <tr>
                                <td><code>headerToolbar</code></td>
                                <td>Object</td>
                                <td>Configuration for the calendar's header, with sections for left, center, and right</td>
                            </tr>
                            <tr>
                                <td><code>events</code></td>
                                <td>Array/Function/String</td>
                                <td>The events to display on the calendar. Can be an array of event objects, a function, or a URL</td>
                            </tr>
                            <tr>
                                <td><code>editable</code></td>
                                <td>Boolean</td>
                                <td>Whether the events can be dragged and resized</td>
                            </tr>
                            <tr>
                                <td><code>selectable</code></td>
                                <td>Boolean</td>
                                <td>Whether dates can be selected by clicking and dragging</td>
                            </tr>
                            <tr>
                                <td><code>businessHours</code></td>
                                <td>Object/Boolean</td>
                                <td>Emphasizes certain time slots on the calendar</td>
                            </tr>
                            <tr>
                                <td><code>nowIndicator</code></td>
                                <td>Boolean</td>
                                <td>Whether to show an indicator for the current time</td>
                            </tr>
                            <tr>
                                <td><code>weekNumbers</code></td>
                                <td>Boolean</td>
                                <td>Whether to show week numbers</td>
                            </tr>
                            <tr>
                                <td><code>height</code></td>
                                <td>Number/String/Function</td>
                                <td>Sets the height of the calendar. Can be 'auto', a pixel value, or 'parent'</td>
                            </tr>
                            <tr>
                                <td><code>themeSystem</code></td>
                                <td>String</td>
                                <td>The theme system to use. In SmartAdmin, set this to 'bootstrap'</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div class="pro-tip">
                    <strong>Pro Tip:</strong> When using FullCalendar with SmartAdmin, always set <code>themeSystem: 'bootstrap'</code> to use the custom Bootstrap theme integration.
                </div>
            </section>

            <section id="fullcalendar-events" class="concept-section">
                <h2 class="concept-title">Event Handling</h2>
                <p>FullCalendar provides extensive event handling capabilities. Here's how to define and manage events:</p>
                
                <h4>Event Object Properties</h4>
                <div class="code-example">
                    <pre><code>// Basic event object structure
{
    id: '123',                      // Unique identifier
    title: 'Meeting with Client',   // Event title
    start: '2023-01-10T10:30:00',   // Start date/time (ISO8601 format)
    end: '2023-01-10T12:30:00',     // End date/time (optional)
    allDay: false,                  // Whether it's an all-day event
    url: 'https://example.com',     // Makes the event clickable as a link (optional)
    className: 'bg-success',        // CSS class names for styling (optional)
    editable: true,                 // Whether this specific event is editable (optional)
    extendedProps: {                // Additional custom data (optional)
        department: 'Marketing',
        location: 'Conference Room A'
    }
}</code></pre>
                </div>

                <h4>Event Sources</h4>
                <div class="code-example">
                    <pre><code>// Array of event objects
events: [
    { title: 'Event 1', start: '2023-01-01' },
    { title: 'Event 2', start: '2023-01-05', end: '2023-01-07' }
]

// JSON feed (AJAX)
events: '/api/events'

// Function that fetches events
events: function(info, successCallback, failureCallback) {
    console.log('Fetching events for', info.startStr, 'to', info.endStr);
    
    fetch('/api/events?start=' + info.startStr + '&end=' + info.endStr)
        .then(response => {
            if (!response.ok) {
                throw new Error('Network response was not ok');
            }
            return response.json();
        })
        .then(data => {
            console.log('Loaded events:', data);
            successCallback(data);
        })
        .catch(error => {
            console.error('Error loading events:', error);
            failureCallback(error);
        });
}

// Multiple event sources with different colors
eventSources: [
    {
        url: '/api/events/team-a',
        color: 'var(--success-500)',   // All events from this source will be this color
        textColor: 'white'             // Text color for this source
    },
    {
        url: '/api/events/team-b',
        color: 'var(--info-500)', 
        textColor: 'white'
    }
]</code></pre>
                </div>

                <h4>Event Callbacks</h4>
                <div class="code-example">
                    <pre><code>const calendar = new Calendar(calendarEl, {
    // ...other options
    
    // Triggered when an event is clicked
    eventClick: function(info) {
        alert('Event: ' + info.event.title);
        
        // Change the background color of the event
        info.event.setProp('backgroundColor', 'var(--danger-500)');
        
        // To prevent default action (URL navigation)
        info.jsEvent.preventDefault();
    },
    
    // Triggered when an event is dragged and dropped
    eventDrop: function(info) {
        if (!confirm("Are you sure you want to move this event?")) {
            info.revert(); // Revert the change
        } else {
            // Update the event in your database
            updateEventInDatabase(info.event);
        }
    },
    
    // Triggered when an event is resized
    eventResize: function(info) {
        alert('Event has been resized. New end time: ' + info.event.end);
    },
    
    // Triggered when dates are selected by clicking and dragging
    select: function(info) {
        const title = prompt('Enter a new title for your event:');
        if (title) {
            calendar.addEvent({
                title: title,
                start: info.startStr,
                end: info.endStr,
                allDay: info.allDay
            });
        }
        calendar.unselect(); // Clear selection
    }
});</code></pre>
                </div>
            </section>

            <section id="fullcalendar-advanced" class="concept-section">
                <h2 class="concept-title">Advanced Features</h2>
                
                <h4>API Methods</h4>
                <div class="code-example">
                    <pre><code>// Get a reference to the calendar
const calendar = new Calendar(calendarEl, options);
calendar.render();

// Navigate to different dates
calendar.next();     // Move to next month/week/day
calendar.prev();     // Move to previous month/week/day
calendar.today();    // Move to today
calendar.gotoDate('2023-05-01'); // Jump to a specific date

// Change views
calendar.changeView('timeGridWeek');  // Switch to week view
calendar.changeView('dayGridMonth');  // Switch to month view

// Event manipulation
const event = calendar.getEventById('123');
if (event) {
    event.setProp('title', 'Updated Title');   // Update title
    event.setStart('2023-01-12T10:00:00');     // Update start time
    event.setEnd('2023-01-12T12:00:00');       // Update end time
    event.setAllDay(true);                     // Make it an all-day event
    event.setExtendedProp('status', 'confirmed'); // Update custom property
    event.remove();                            // Remove the event
}

// Add a new event
calendar.addEvent({
    title: 'New Event',
    start: '2023-01-15'
});

// Programmatically select dates
calendar.select('2023-01-24', '2023-01-26');

// Refetch events (if using dynamic source)
calendar.refetchEvents();</code></pre>
                </div>

                <h4>Localization</h4>
                <div class="code-example">
                    <pre><code>// Import the locale
import frLocale from '@fullcalendar/core/locales/fr';

const calendar = new Calendar(calendarEl, {
    // ...other options
    locale: frLocale,   // Use French locale
    
    // Or use multiple locales
    locales: [frLocale, esLocale],
    locale: 'fr'        // Set the active locale
});</code></pre>
                </div>

                <h4>Business Hours</h4>
                <div class="code-example">
                    <pre><code>// Simple business hours (9am to 5pm, Monday to Friday)
businessHours: true

// Customized business hours
businessHours: {
    daysOfWeek: [1, 2, 3, 4, 5], // Monday to Friday
    startTime: '08:00',           // 8am
    endTime: '18:00'              // 6pm
}

// Multiple business hour ranges
businessHours: [
    {
        daysOfWeek: [1, 2, 3, 4], // Monday to Thursday
        startTime: '08:00',
        endTime: '18:00'
    },
    {
        daysOfWeek: [5],          // Friday
        startTime: '08:00',
        endTime: '14:00'          // 2pm (shorter day)
    }
]</code></pre>
                </div>
            </section>

            <section id="fullcalendar-smartadmin" class="concept-section">
                <h2 class="concept-title">SmartAdmin Integration</h2>
                <p>For optimal integration with SmartAdmin, consider these tips:</p>

                <h4>Event Colors</h4>
                <p>Use SmartAdmin color variables for consistent styling:</p>
                <div class="code-example">
                    <pre><code>// Use SmartAdmin color variables
events: [
    {
        title: 'Critical Task',
        start: '2023-01-05',
        backgroundColor: 'var(--danger-500)',
        borderColor: 'var(--danger-500)'
    },
    {
        title: 'Team Meeting',
        start: '2023-01-07',
        backgroundColor: 'var(--primary-500)',
        borderColor: 'var(--primary-500)'
    },
    {
        title: 'Completed Project',
        start: '2023-01-09',
        backgroundColor: 'var(--success-500)',
        borderColor: 'var(--success-500)'
    }
]

// Or use predefined SmartAdmin classes
events: [
    {
        title: 'Warning Event',
        start: '2023-01-11',
        classNames: ['bg-warning-500', 'text-white']
    },
    {
        title: 'Info Event',
        start: '2023-01-13',
        classNames: ['bg-info-500', 'text-white']
    }
]</code></pre>
                </div>

                <h4>Panel Integration</h4>
                <p>Use SmartAdmin panels for a consistent look:</p>
                <div class="code-example">
                    <pre><code>&lt;div class="row"&gt;
    &lt;div class="col-xl-12"&gt;
        &lt;div id="panel-1" class="panel"&gt;
            &lt;div class="panel-hdr"&gt;
                &lt;h2&gt;
                    Company &lt;span class="fw-300"&gt;&lt;i&gt;Calendar&lt;/i&gt;&lt;/span&gt;
                &lt;/h2&gt;
                &lt;div class="panel-toolbar"&gt;
                    &lt;button class="btn btn-panel" data-action="panel-collapse"&gt;
                        &lt;svg class="sa-icon"&gt;
                            &lt;use class="panel-collapsed-icon" href="img/sprite.svg#minus-circle"&gt;&lt;/use&gt;
                            &lt;use class="panel-expand-icon" href="img/sprite.svg#plus-circle"&gt;&lt;/use&gt;
                        &lt;/svg&gt;
                    &lt;/button&gt;
                    &lt;button class="btn btn-panel" data-action="panel-fullscreen"&gt;
                        &lt;svg class="sa-icon"&gt;
                            &lt;use href="img/sprite.svg#stop-circle"&gt;&lt;/use&gt;
                        &lt;/svg&gt;
                    &lt;/button&gt;
                &lt;/div&gt;
            &lt;/div&gt;
            &lt;div class="panel-container show"&gt;
                &lt;div class="panel-content"&gt;
                    &lt;div id="calendar"&gt;&lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/div&gt;</code></pre>
                </div>

                <h4>Modal Integration for Event Details</h4>
                <div class="code-example">
                    <pre><code>// Calendar setup with event click handling for modals
const calendar = new Calendar(calendarEl, {
    // ...other options
    eventClick: function(info) {
        // Prevent default action (URL navigation)
        info.jsEvent.preventDefault();
        
        // Get event details
        const event = info.event;
        const title = event.title;
        const start = event.start ? event.start.toLocaleString() : '';
        const end = event.end ? event.end.toLocaleString() : '';
        const description = event.extendedProps.description || '';
        
        // Populate and show modal with Bootstrap 5
        const modal = new bootstrap.Modal(document.getElementById('event-details-modal'));
        document.getElementById('modal-event-title').textContent = title;
        document.getElementById('modal-event-time').textContent = start + ' - ' + end;
        document.getElementById('modal-event-description').textContent = description;
        
        // Set up edit/delete buttons if needed
        document.getElementById('edit-event-btn').onclick = function() {
            // Open edit form for this event
            openEditForm(event);
            modal.hide();
        };
        
        document.getElementById('delete-event-btn').onclick = function() {
            if (confirm('Are you sure you want to delete this event?')) {
                event.remove();
                // Also delete from backend
                deleteEventFromServer(event.id);
                modal.hide();
            }
        };
        
        modal.show();
    }
});</code></pre>
                </div>
            </section>

            <section id="fullcalendar-troubleshooting" class="concept-section">
                <h2 class="concept-title">Troubleshooting</h2>
                <div class="warning">
                    <strong>Common Issues:</strong>
                    <ul class="mb-0">
                        <li><strong>Calendar not displaying?</strong> Ensure the container has a defined height.</li>
                        <li><strong>Events not appearing?</strong> Check the date range and time format of your events.</li>
                        <li><strong>Styling issues?</strong> Make sure <code>themeSystem: 'bootstrap'</code> is set.</li>
                        <li><strong>Icons not showing?</strong> Verify the custom theme is properly loaded.</li>
                    </ul>
                </div>
                
                <h4>Calendar Height Issues</h4>
                <div class="code-example">
                    <pre><code>// Set explicit height
const calendar = new Calendar(calendarEl, {
    // ...other options
    height: 800  // Explicit pixel height
});

// Or use parent container's height
const calendar = new Calendar(calendarEl, {
    // ...other options
    height: 'parent'  // Use parent container's height
});

// Or use CSS
#calendar {
    height: 800px;
}

// For responsive height
#calendar {
    height: calc(100vh - 250px); /* Viewport height minus offset */
}
</code></pre>
                </div>
                
                <h4>AJAX Loading Issues</h4>
                <div class="code-example">
                    <pre><code>// Debug AJAX event loading
events: function(info, successCallback, failureCallback) {
    console.log('Fetching events for', info.startStr, 'to', info.endStr);
    
    fetch('/api/events?start=' + info.startStr + '&end=' + info.endStr)
        .then(response => {
            if (!response.ok) {
                throw new Error('Network response was not ok');
            }
            return response.json();
        })
        .then(data => {
            console.log('Loaded events:', data);
            successCallback(data);
        })
        .catch(error => {
            console.error('Error loading events:', error);
            failureCallback(error);
        });
}</code></pre>
                </div>
            </section>

            <section id="fullcalendar-resources" class="concept-section">
                <h2 class="concept-title">Further Resources</h2>
                <p>For more advanced usage and detailed API documentation, refer to these resources:</p>
                
                <ul class="list-spaced">
                    <li><a href="https://fullcalendar.io/docs" target="_blank">Official FullCalendar Documentation</a></li>
                    <li><a href="https://fullcalendar.io/docs/bootstrap-theme" target="_blank">FullCalendar Bootstrap Theme Documentation</a></li>
                    <li><a href="https://github.com/fullcalendar/fullcalendar" target="_blank">FullCalendar GitHub Repository</a></li>
                    <li><a href="https://fullcalendar.io/docs/plugin-index" target="_blank">Available FullCalendar Plugins</a></li>
                </ul>
            </section>
            </div>

            <div class="order-1 order-xl-2 col-lg-12 col-xl-3 position-relative">
                <!-- Sidebar (Right Side) - Sticky Navigation -->
                <h5 class="mb-3 ps-lg-3">On This Page</h5>
                <ul class="list-unstyled ps-lg-3">
                    <li class="py-1"><a href="#fullcalendar">Introduction</a></li>
                    <li class="py-1"><a href="#fullcalendar-installation">Installation</a></li>
                    <li class="py-1"><a href="#fullcalendar-theme">SmartAdmin Theme</a></li>
                    <li class="py-1"><a href="#fullcalendar-options">Configuration Options</a></li>
                    <li class="py-1"><a href="#fullcalendar-events">Event Handling</a></li>
                    <li class="py-1"><a href="#fullcalendar-advanced">Advanced Features</a></li>
                    <li class="py-1"><a href="#fullcalendar-smartadmin">SmartAdmin Integration</a></li>
                    <li class="py-1"><a href="#fullcalendar-troubleshooting">Troubleshooting</a></li>
                    <li class="py-1"><a href="#fullcalendar-resources">Further Resources</a></li>
                </ul>
            </div>
        </div>
    </div>
    `
}) %> 